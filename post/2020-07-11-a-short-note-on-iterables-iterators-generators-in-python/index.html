<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>A short note on iterables, iterators, generators in Python | My Notes</title><meta name=keywords content="python"><meta name=description content="A test post"><meta name=author content="lkk7"><link rel=canonical href=https://www.lkk7.com/notes/post/2020-07-11-a-short-note-on-iterables-iterators-generators-in-python/><link crossorigin=anonymous href=/notes/assets/css/stylesheet.min.48a18943c2fc15c38a372b8dde1f5e5dc0bc64fa6cb90f5a817d2f8c76b7f3ae.css integrity="sha256-SKGJQ8L8FcOKNyuN3h9eXcC8ZPpsuQ9agX0vjHa3864=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/notes/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.lkk7.com/notes/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.lkk7.com/notes/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.lkk7.com/notes/favicon-32x32.png><link rel=apple-touch-icon href=https://www.lkk7.com/notes/apple-touch-icon.png><link rel=mask-icon href=https://www.lkk7.com/notes/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="A short note on iterables, iterators, generators in Python"><meta property="og:description" content="A test post"><meta property="og:type" content="article"><meta property="og:url" content="https://www.lkk7.com/notes/post/2020-07-11-a-short-note-on-iterables-iterators-generators-in-python/"><meta property="article:section" content="post"><meta property="article:published_time" content="2020-07-11T00:00:00+02:00"><meta property="article:modified_time" content="2020-07-11T00:00:00+02:00"><meta property="og:site_name" content="My Notes"><meta name=twitter:card content="summary"><meta name=twitter:title content="A short note on iterables, iterators, generators in Python"><meta name=twitter:description content="A test post"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://www.lkk7.com/notes/post/"},{"@type":"ListItem","position":3,"name":"A short note on iterables, iterators, generators in Python","item":"https://www.lkk7.com/notes/post/2020-07-11-a-short-note-on-iterables-iterators-generators-in-python/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"A short note on iterables, iterators, generators in Python","name":"A short note on iterables, iterators, generators in Python","description":"A test post","keywords":["python"],"articleBody":"This subject may seem complicated: generators create generator iterators (which are iterables). To make that sentence sound understandable, here’s a short note about the topic.\n(Type hinting in every code snippet has been omitted for simplicity)\nIterables The docs [1] briefly explain iterables:\nAn object capable of returning its members one at a time. Examples of iterables include all sequence types (such as list, str, and tuple) and some non-sequence types like dict, file objects […] Iterables can be used in a for loop and in many other places where a sequence is needed (zip(), map(), …).\nIn essence, iterables are everything that you can loop over with a for loop.\nAn important detail is that they have a method __iter__() which returns an iterator for them (or an equivalent iter() built-in function).\nIterators An iterator is an object used to iterate over iterables. When we loop over a list with a for statement, the iterator is created behind the scenes and we don’t have to worry about it. However, we can try to manually loop over the list with an iterator like this:\nnumbers = [1, 2, 3] it = iter(numbers) # This is the iterator object print(it.__next__()) # 1 print(it.__next__()) # 2 print(next(it)) # 3 (this is the same thing as __next__()) print(it.__next__()) # StopIteration exception As we see, an iterator gets “worn out” after it has iterated over everything it had to. It throws a special StopIteration exception. We’d have to create a new iterator if we wanted to iterate again. Besides the __next__() method (which is synonymous to calling next() on the iterator, as seen in example above), the iterator should also have a method __iter__ [1]. It just returns the iterator itself, making any iterator also an iterable (because, as I pointed out in the earlier section, every iterable has a __next__() method).\na = iter([1, 2, 3]) print(a is a.__iter__()) # True Generators A generator is a function which returns a generator iterator (just a special kind of iterator). This iterator is returned through usage of yield keyword. As the docs [1] say:\nEach yield temporarily suspends processing, remembering the location execution state (including local variables and pending try-statements). When the generator iterator resumes, it picks up where it left off (in contrast to functions which start fresh on every invocation).\nLet’s clear this up with an example:\ndef double_range(start, stop):  for i in range(start, stop): \tyield 2 * i it = double_range(0, 3) # our generator iterator, has the __next__ method print(it) #  print(it.__next__()) # 0 print(it.__next__()) # 2 print(next(it)) # 4 print(next(it)) # StopIteration exception The shortest and simplest explanation is: the generator iterator returned from our double_range function is like a list, but we retrieve elements one at a time, when they are needed. That is called lazy evaluation. Subsequent calls to __next__() get subsequent elements. They aren’t all calculated at it = double_range(0, 3) line. They would be calculated at definition time if we used a list:\na = double_range(0, 3) print(a) #  a = [2 * i for i in range(0, 3)] print(a) # [0, 2, 4] In fact, we used list comprehension syntax there. Is there a “generator comprehension”? Yes, and we call it a generator expression:\na = (2 * i for i in range(0, 3)) print(a) # at 0x104cd9660 print(next(a)) # 0 print(a.__next__()) # 2 print(next(a)) # 4 print(next(a)) # StopIteration exception Definitely shorter syntax than a full function, and it does the same thing. However, it could be discussed if it’s more readable. Also, do not mistake generator expressions for tuples.\nA very short note about use cases for generators I believe that the information presented here is more than enough to start using generators. But why would we want to use them? They may seem like a worse list/tuple at first. It turns out there’s a big advantage to them – memory usage. As we know now, generators calculate elements of a sequence one at a time. That may save memory and allow us to process large files, theoretically infinite sequences or “online” data streams.\nThe simplest example – creating infinite sequences over which we can iterate easily:\ndef numbers():  n = -999999999  while True:  yield n  n += 1  for i in numbers():  print(i) # -999999999, -999999998, ... Sources:  [1] https://docs.python.org Python Software Foundation. Python Documentation ","wordCount":"736","inLanguage":"en","datePublished":"2020-07-11T00:00:00+02:00","dateModified":"2020-07-11T00:00:00+02:00","author":{"@type":"Person","name":"lkk7"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.lkk7.com/notes/post/2020-07-11-a-short-note-on-iterables-iterators-generators-in-python/"},"publisher":{"@type":"Organization","name":"My Notes","logo":{"@type":"ImageObject","url":"https://www.lkk7.com/notes/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.lkk7.com/notes accesskey=h title="My Notes (Alt + H)">My Notes</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://www.lkk7.com/notes/ title="Home (notes)"><span>Home (notes)</span></a></li><li><a href=https://www.lkk7.com/notes/archives title=Archives><span>Archives</span></a></li><li><a href=https://www.lkk7.com title="My Page"><span>My Page</span></a></li><li><a href=https://www.lkk7.com/notes/tags title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.lkk7.com/notes>Home</a>&nbsp;»&nbsp;<a href=https://www.lkk7.com/notes/post/>Posts</a></div><h1 class=post-title>A short note on iterables, iterators, generators in Python</h1><div class=post-description>A test post</div><div class=post-meta><span title="2020-07-11 00:00:00 +0200 +0200">July 11, 2020</span>&nbsp;·&nbsp;lkk7</div></header><div class=post-content><p>This subject may seem complicated: generators create generator iterators (which are iterables). To make that sentence sound understandable, here&rsquo;s a short note about the topic.</p><p><strong>(Type hinting in every code snippet has been omitted for simplicity)</strong></p><h3 id=iterables>Iterables<a hidden class=anchor aria-hidden=true href=#iterables>#</a></h3><p>The docs [1] briefly explain iterables:<br><em>An object capable of returning its members one at a time. Examples of iterables include all sequence types (such as list, str, and tuple) and some non-sequence types like dict, file objects [&mldr;] Iterables can be used in a for loop and in many other places where a sequence is needed (zip(), map(), …).</em><br>In essence, iterables are everything that you can loop over with a <code>for</code> loop.</p><p>An important detail is that they have a method <code>__iter__()</code> which returns an iterator for them (or an equivalent <code>iter()</code> built-in function).</p><h3 id=iterators>Iterators<a hidden class=anchor aria-hidden=true href=#iterators>#</a></h3><p>An iterator is an object used to iterate over iterables. When we loop over a list with a <code>for</code> statement, the iterator is created behind the scenes and we don&rsquo;t have to worry about it. However, we can try to manually loop over the list with an iterator like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>numbers <span style=color:#f92672>=</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>]
</span></span><span style=display:flex><span>it <span style=color:#f92672>=</span> iter(numbers)   <span style=color:#75715e># This is the iterator object</span>
</span></span><span style=display:flex><span>print(it<span style=color:#f92672>.</span>__next__()) <span style=color:#75715e># 1</span>
</span></span><span style=display:flex><span>print(it<span style=color:#f92672>.</span>__next__()) <span style=color:#75715e># 2</span>
</span></span><span style=display:flex><span>print(next(it))      <span style=color:#75715e># 3 (this is the same thing as __next__())</span>
</span></span><span style=display:flex><span>print(it<span style=color:#f92672>.</span>__next__()) <span style=color:#75715e># StopIteration exception</span>
</span></span></code></pre></div><p>As we see, an iterator gets &ldquo;worn out&rdquo; after it has iterated over everything it had to. It throws a special StopIteration exception. We&rsquo;d have to create a new iterator if we wanted to iterate again. Besides the <code>__next__()</code> method (which is synonymous to calling <code>next()</code> on the iterator, as seen in example above), the iterator should also have a method <code>__iter__</code> [1]. It just returns the iterator itself, making any iterator also an iterable (because, as I pointed out in the earlier section, every iterable has a <code>__next__()</code> method).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>a <span style=color:#f92672>=</span> iter([<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>])
</span></span><span style=display:flex><span>print(a <span style=color:#f92672>is</span> a<span style=color:#f92672>.</span>__iter__())  <span style=color:#75715e># True</span>
</span></span></code></pre></div><h3 id=generators>Generators<a hidden class=anchor aria-hidden=true href=#generators>#</a></h3><p>A generator is a function which returns a generator iterator (just a special kind of iterator). This iterator is returned through usage of <code>yield</code> keyword. As the docs [1] say:<br><em>Each yield temporarily suspends processing, remembering the location execution state (including local variables and pending try-statements). When the generator iterator resumes, it picks up where it left off (in contrast to functions which start fresh on every invocation).</em></p><p>Let&rsquo;s clear this up with an example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>double_range</span>(start, stop):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(start, stop):
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>yield</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> i
</span></span><span style=display:flex><span>it <span style=color:#f92672>=</span> double_range(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>3</span>)  <span style=color:#75715e># our generator iterator, has the __next__ method</span>
</span></span><span style=display:flex><span>print(it)                <span style=color:#75715e># &lt;generator object double at 0x10e900820&gt;</span>
</span></span><span style=display:flex><span>print(it<span style=color:#f92672>.</span>__next__())     <span style=color:#75715e># 0</span>
</span></span><span style=display:flex><span>print(it<span style=color:#f92672>.</span>__next__())     <span style=color:#75715e># 2</span>
</span></span><span style=display:flex><span>print(next(it))          <span style=color:#75715e># 4</span>
</span></span><span style=display:flex><span>print(next(it))          <span style=color:#75715e># StopIteration exception</span>
</span></span></code></pre></div><p>The shortest and simplest explanation is: the generator iterator returned from our <code>double_range</code> function is like a list, but we retrieve elements one at a time, when they are needed. That is called <strong>lazy evaluation</strong>. Subsequent calls to <code>__next__()</code> get subsequent elements. They aren&rsquo;t all calculated at <code>it = double_range(0, 3)</code> line. They would be calculated at definition time if we used a list:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>a <span style=color:#f92672>=</span> double_range(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>print(a)  <span style=color:#75715e># &lt;generator object double_range at 0x104cd9200&gt;</span>
</span></span><span style=display:flex><span>a <span style=color:#f92672>=</span> [<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> i <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>3</span>)]
</span></span><span style=display:flex><span>print(a)  <span style=color:#75715e># [0, 2, 4]</span>
</span></span></code></pre></div><p>In fact, we used list comprehension syntax there. Is there a &ldquo;generator comprehension&rdquo;? Yes, and we call it a generator expression:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>a <span style=color:#f92672>=</span> (<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> i <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>3</span>))
</span></span><span style=display:flex><span>print(a)            <span style=color:#75715e># &lt;generator object &lt;genexpr&gt; at 0x104cd9660&gt;</span>
</span></span><span style=display:flex><span>print(next(a))      <span style=color:#75715e># 0</span>
</span></span><span style=display:flex><span>print(a<span style=color:#f92672>.</span>__next__()) <span style=color:#75715e># 2</span>
</span></span><span style=display:flex><span>print(next(a))      <span style=color:#75715e># 4</span>
</span></span><span style=display:flex><span>print(next(a))      <span style=color:#75715e># StopIteration exception</span>
</span></span></code></pre></div><p>Definitely shorter syntax than a full function, and it does the same thing. However, it could be discussed if it&rsquo;s more readable. Also, do not mistake generator expressions for tuples.</p><h3 id=a-very-short-note-about-use-cases-for-generators>A very short note about use cases for generators<a hidden class=anchor aria-hidden=true href=#a-very-short-note-about-use-cases-for-generators>#</a></h3><p>I believe that the information presented here is more than enough to start using generators. But why would we want to use them? They may seem like a worse list/tuple at first. It turns out there&rsquo;s a big advantage to them – memory usage. As we know now, generators calculate elements of a sequence one at a time. That may save memory and allow us to process large files, theoretically infinite sequences or &ldquo;online&rdquo; data streams.</p><p>The simplest example – creating infinite sequences over which we can iterate easily:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>numbers</span>():
</span></span><span style=display:flex><span>    n <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>999999999</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>yield</span> n
</span></span><span style=display:flex><span>        n <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> numbers():
</span></span><span style=display:flex><span>    print(i)
</span></span><span style=display:flex><span><span style=color:#75715e># -999999999, -999999998, ...</span>
</span></span></code></pre></div><h2 id=sources>Sources:<a hidden class=anchor aria-hidden=true href=#sources>#</a></h2><ul><li>[1] <a href=https://docs.python.org>https://docs.python.org</a> Python Software Foundation. Python Documentation</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.lkk7.com/notes/tags/python/>python</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://www.lkk7.com/notes>My Notes</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>